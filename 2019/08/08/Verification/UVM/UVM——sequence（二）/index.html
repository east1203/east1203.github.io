

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="https://raw.githubusercontent.com/east1203/MarkdownPhoto/master/icon/icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Yongkang Dong">
  <meta name="keywords" content="芯片 验证 读书 编程">
  
    <meta name="description" content="6. virtual sequence​    如果被嵌套的sequence需要在不同的sequencer中启动，也就是需要sequence之间同步，那么此时的嵌套sequence就是virtual sequence。它不产生transaction，只是控制其它sequence产生transaction发送给不同的sequencer，这就是为什么是virtual。 ​    virtual seq">
<meta property="og:type" content="article">
<meta property="og:title" content="UVM——sequence（二）">
<meta property="og:url" content="http://example.com/2019/08/08/Verification/UVM/UVM%E2%80%94%E2%80%94sequence%EF%BC%88%E4%BA%8C%EF%BC%89/index.html">
<meta property="og:site_name" content="北方天">
<meta property="og:description" content="6. virtual sequence​    如果被嵌套的sequence需要在不同的sequencer中启动，也就是需要sequence之间同步，那么此时的嵌套sequence就是virtual sequence。它不产生transaction，只是控制其它sequence产生transaction发送给不同的sequencer，这就是为什么是virtual。 ​    virtual seq">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-08-07T16:00:00.000Z">
<meta property="article:modified_time" content="2022-03-12T03:51:25.819Z">
<meta property="article:author" content="Yongkang Dong">
<meta property="article:tag" content="IC">
<meta property="article:tag" content="SV">
<meta property="article:tag" content="Verification">
<meta property="article:tag" content="UVM">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>UVM——sequence（二） - 北方天</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>East1203</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    
                    Archives
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    
                    Categories
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    
                    Tags
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/source/">
                
                source
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://raw.githubusercontent.com/east1203/MarkdownPhoto/master/background/back2.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="UVM——sequence（二）">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2019-08-08 00:00" pubdate>
        August 8, 2019 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      14k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      117 分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">UVM——sequence（二）</h1>
            
            <div class="markdown-body">
              <h3 id="6-virtual-sequence"><a href="#6-virtual-sequence" class="headerlink" title="6. virtual sequence"></a>6. virtual sequence</h3><p>​    如果被嵌套的sequence需要在不同的sequencer中启动，也就是需要<strong>sequence之间同步</strong>，那么此时的嵌套sequence就是virtual sequence。它不产生transaction，只是控制其它sequence产生transaction发送给不同的sequencer，这就是为什么是virtual。</p>
<p>​    virtual sequence可以在启动的时候不需要sequencer，把它设成null，这也是它被称为virtual的另一个原因。</p>
<h4 id="6-1-sequence通过find函数拿到启动sequencer"><a href="#6-1-sequence通过find函数拿到启动sequencer" class="headerlink" title="6.1 sequence通过find函数拿到启动sequencer"></a>6.1 sequence通过find函数拿到启动sequencer</h4><p>​    virtual sequence中的sequence需要拿到启动的sequencer，这可以通过<strong>uvm_top的find函数</strong>，<strong>find函数通过传入component实例的名字可以返回这个实例的句柄，find函数返回uvm_component类型，需要转化哼真正的sequencer类型</strong>，这样就拿到了每个要启动的sequencer。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-keyword">class</span> runall_sequence <span class="hljs-keyword">extends</span> uvm_sequence <span class="hljs-variable">#(uvm_sequence_item)</span>;<span class="hljs-comment">// virtual sequence</span><br>   `uvm_object_utils(runall_sequence);<br><br>   <span class="hljs-keyword">protected</span> reset_sequence reset;<br>   <span class="hljs-keyword">protected</span> maxmult_sequence maxmult;<br>   <span class="hljs-keyword">protected</span> random_sequence random;<br>   <span class="hljs-keyword">protected</span> sequencer sequencer_h;<br>   <span class="hljs-keyword">protected</span> uvm_component uvm_component_h;<span class="hljs-comment">//find函数返回uvm_component类型</span><br>   <br> <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span>(<span class="hljs-keyword">string</span> name = <span class="hljs-string">&quot;runall_sequence&quot;</span>);<br>   <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name);<br>    <br>     uvm_component_h =  uvm_top<span class="hljs-variable">.find</span>(<span class="hljs-string">&quot;*.env_h.sequencer_h&quot;</span>);<span class="hljs-comment">// 拿到启动的sequencer</span><br>     <span class="hljs-comment">// sequencer_h是env中的sequencer</span><br><br>    <span class="hljs-keyword">if</span> (uvm_component_h == <span class="hljs-literal">null</span>)<br>     `uvm_fatal(<span class="hljs-string">&quot;RUNALL SEQUENCE&quot;</span>, <span class="hljs-string">&quot;Failed to get the sequencer&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">$cast</span>(sequencer_h, uvm_component_h))<span class="hljs-comment">//将sequence_h转化成sequencer类型</span><br>      `uvm_fatal(<span class="hljs-string">&quot;RUNALL SEQUENCE&quot;</span>, <span class="hljs-string">&quot;Failed to cast from uvm_component_h.&quot;</span>)<br>     <br>    reset = reset_sequence::type_id::create(<span class="hljs-string">&quot;reset&quot;</span>);<br>    maxmult = maxmult_sequence::type_id::create(<span class="hljs-string">&quot;maxmult&quot;</span>);<br>    random = random_sequence::type_id::create(<span class="hljs-string">&quot;random&quot;</span>);<br> <span class="hljs-keyword">endfunction</span> : <span class="hljs-keyword">new</span><br><br> <span class="hljs-keyword">task</span> body();<br>     reset<span class="hljs-variable">.start</span>(sequencer_h);<span class="hljs-comment">//在sequencer上启动sequence</span><br>    maxmult<span class="hljs-variable">.start</span>(sequencer_h);<br>    random<span class="hljs-variable">.start</span>(sequencer_h);<br> <span class="hljs-keyword">endtask</span> : body<br>   <br><span class="hljs-keyword">endclass</span> : runall_sequence<br></code></pre></td></tr></table></figure>

<p>virtual sequence的启动，因为上面通过find，每个sequence都拿到了sequencer，所以virtual sequence不需要指定sequencer。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Verilog"><span class="hljs-keyword">class</span> full_test <span class="hljs-keyword">extends</span> tinyalu_base_test;<br>   `uvm_component_utils(full_test);<br>   <br>   runall_sequence runall_seq;<span class="hljs-comment">//定义virtual sequence</span><br><br>   <span class="hljs-keyword">task</span> run_phase(uvm_phase phase);<br>      runall_seq = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;runall_seq&quot;</span>);<br>      phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>       runall_seq<span class="hljs-variable">.start</span>(<span class="hljs-literal">null</span>); <span class="hljs-comment">//启动virtual sequence，不需要指定sequencer</span><br>      phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br>   <span class="hljs-keyword">endtask</span> : run_phase<br><br>   <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span> (<span class="hljs-keyword">string</span> name, uvm_component parent);<br>      <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name,parent);<br>   <span class="hljs-keyword">endfunction</span> : <span class="hljs-keyword">new</span><br><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<h4 id="6-2-通过virtual-sequencer指定每个sequence的sequencer"><a href="#6-2-通过virtual-sequencer指定每个sequence的sequencer" class="headerlink" title="6.2 通过virtual sequencer指定每个sequence的sequencer"></a>6.2 通过virtual sequencer指定每个sequence的sequencer</h4><p>除了上面的find函数，还可以通过virtual sequencer指定每个sequence的sequencer。</p>
<p><strong>virtual sequencer中保存多个sequencer的句柄，指向真正要发送transaction的sequencer。</strong></p>
<p>virtual sequencer是对不同sequencer的封装，本身不发送transaction，主要让程序看起来舒服，容易理解——virtual sequence在virtual sequencer上启动，virtual sequence中的sequence在virtual sequencer中的sequencer启动。</p>
<p><strong>Virtual sequencer 有三个属性：</strong></p>
<p>(1)Virtual sequencer控制其他的sequencer</p>
<p>(2)Virtual sequencer并不和任何driver相连</p>
<p>(3)Virtual sequencer本身并不处理item</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Verilog"><span class="hljs-comment">//定义virtualsequencer</span><br><span class="hljs-keyword">class</span> my_vsqr <span class="hljs-keyword">extends</span> uvm_sequencer;<span class="hljs-comment">//不需要指定要发送的transaction类型</span><br>  <br>   my_sequencer p_sqr0;<br>   my_sequencer p_sqr1;<br>   <br>   <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span>(<span class="hljs-keyword">string</span> name, uvm_component parent);<br>      <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name, parent);<br>   <span class="hljs-keyword">endfunction</span> <br>   <br>   `uvm_component_utils(my_vsqr)<br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">//定义virtual sequence</span><br><span class="hljs-keyword">class</span> case0_vseq <span class="hljs-keyword">extends</span> uvm_sequence;<span class="hljs-comment">//不需要指定要发送的transaction类型</span><br>   `uvm_object_utils(case0_vseq)<br>   `uvm_declare_p_sequencer(my_vsqr) <br>...<br>   <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>      my_transaction tr;<br>      read_file_seq seq0;<br>      drv1_seq seq1;<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>      `uvm_do_on_with(tr, p_sequencer<span class="hljs-variable">.p_sqr0</span>, &#123;tr<span class="hljs-variable">.pload</span><span class="hljs-variable">.size</span> == <span class="hljs-number">1500</span>;&#125;)<br>      `uvm_info(<span class="hljs-string">&quot;vseq&quot;</span>, <span class="hljs-string">&quot;send one longest packet on p_sequencer.p_sqr0&quot;</span>, UVM_MEDIUM)<br>      seq0 = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;seq0&quot;</span>);<br>      seq0<span class="hljs-variable">.file_name</span> = <span class="hljs-string">&quot;data.txt&quot;</span>;<br>      seq1 = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;seq1&quot;</span>);<br>      <span class="hljs-keyword">fork</span><br>          seq0<span class="hljs-variable">.start</span>(p_sequencer<span class="hljs-variable">.p_sqr0</span>);<span class="hljs-comment">//在sqr0上启动seq0</span><br>         seq1<span class="hljs-variable">.start</span>(p_sequencer<span class="hljs-variable">.p_sqr1</span>);<br>      <span class="hljs-keyword">join</span> <br>      #<span class="hljs-number">100</span>;<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br>   <span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Verilog"><span class="hljs-comment">// 在virtual sequencer上启动virtual sequence</span><br><span class="hljs-keyword">function</span> <span class="hljs-keyword">void</span> my_case0::build_phase(uvm_phase phase);<br>   <span class="hljs-keyword">super</span><span class="hljs-variable">.build_phase</span>(phase);<br><br>   uvm_config_db<span class="hljs-variable">#(uvm_object_wrapper)</span>::set(<span class="hljs-keyword">this</span>, <br>                                           <span class="hljs-string">&quot;v_sqr.main_phase&quot;</span>, <br>                                           <span class="hljs-string">&quot;default_sequence&quot;</span>, <br>                                           case0_vseq::type_id::get());<br><span class="hljs-keyword">endfunction</span><br></code></pre></td></tr></table></figure>

<h4 id="6-3-只在virtual-sequence中控制objection"><a href="#6-3-只在virtual-sequence中控制objection" class="headerlink" title="6.3 只在virtual sequence中控制objection"></a>6.3 只在virtual sequence中控制objection</h4><p>上一节中只在virtual sequence中控制objection。</p>
<p>virtual sequence不仅调度transaction，也对objection进行调度，避免层层查找在哪里调度了objection。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Verilog"><span class="hljs-comment">//非virtual sequence不控制objection</span><br><span class="hljs-keyword">class</span> drv1_seq <span class="hljs-keyword">extends</span> uvm_sequence <span class="hljs-variable">#(my_transaction)</span>;<br>   my_transaction m_trans;<br>   `uvm_object_utils(drv1_seq)<br><br>   <span class="hljs-keyword">function</span>  <span class="hljs-keyword">new</span>(<span class="hljs-keyword">string</span> name= <span class="hljs-string">&quot;drv1_seq&quot;</span>);<br>      <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name);<br>   <span class="hljs-keyword">endfunction</span> <br>   <br>    <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<span class="hljs-comment">//不控制objection</span><br>      <span class="hljs-keyword">repeat</span> (<span class="hljs-number">10</span>) <span class="hljs-keyword">begin</span><br>         `uvm_do(m_trans)<br>         `uvm_info(<span class="hljs-string">&quot;drv1_seq&quot;</span>, <span class="hljs-string">&quot;send one transaction&quot;</span>, UVM_MEDIUM)<br>      <span class="hljs-keyword">end</span><br>   <span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<p>除了手工启动（start函数)时需要给starting_phase赋值外，只有将sequence作为sequencer的某动态运行的phase的default_sequence时，starting_phase才不为null。如果将某sequence作为uvm_do宏的参数，那么此sequence的starting_phase为null。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-comment">// 手工给starting_phase赋值</span><br><span class="hljs-keyword">task</span> my_case0::main_phase(uvm_phase phase);<br>   sequence0 seq0;<br>   sequence1 seq1;<br><br>   seq0 = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;seq0&quot;</span>);<br>   seq0<span class="hljs-variable">.starting_phase</span> = phase;<span class="hljs-comment">//将phase传给seq0的starting_phase</span><br>   seq1 = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;seq1&quot;</span>);<br>   seq1<span class="hljs-variable">.starting_phase</span> = phase;<span class="hljs-comment">//手动启动sequence时需要给starting_phase赋值</span><br>   env<span class="hljs-variable">.i_agt</span><span class="hljs-variable">.sqr</span><span class="hljs-variable">.set_arbitration</span>(SEQ_ARB_STRICT_FIFO);<br>   <span class="hljs-keyword">fork</span><br>       seq0<span class="hljs-variable">.start</span>(env<span class="hljs-variable">.i_agt</span><span class="hljs-variable">.sqr</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">100</span>); <span class="hljs-comment">//指定优先级</span><br>      seq1<span class="hljs-variable">.start</span>(env<span class="hljs-variable">.i_agt</span><span class="hljs-variable">.sqr</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">200</span>);<br>   <span class="hljs-keyword">join</span><br><span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<h4 id="6-4-在sequence慎用fork-join-none"><a href="#6-4-在sequence慎用fork-join-none" class="headerlink" title="6.4 在sequence慎用fork join_none"></a>6.4 在sequence慎用fork join_none</h4><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-keyword">class</span> vseq <span class="hljs-keyword">extends</span> uvm_sequence;<br>	my_sequence seq[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>           <span class="hljs-keyword">fork</span><br>               <span class="hljs-keyword">automatic</span> <span class="hljs-keyword">int</span> j=i;<br>               `uvm_do_on(seq[j],p_sequencer<span class="hljs-variable">.p_sqr</span>[j]);<br>           <span class="hljs-keyword">join_none</span><br>	<span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<p>上面例子中在fork join_none中并行调用&#96;uvm_do，将for展开其实如下：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-keyword">class</span> vseq <span class="hljs-keyword">extends</span> uvm_sequence;<br>	my_sequence seq[<span class="hljs-number">4</span>];<br>     <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>        <span class="hljs-keyword">fork</span><br>          uvm_do_on(seq[<span class="hljs-number">0</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">0</span>]);<br>        <span class="hljs-keyword">join_none</span><br>        <span class="hljs-keyword">fork</span><br>          uvm_do_on(seq[<span class="hljs-number">1</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">join_none</span><br>        <span class="hljs-keyword">fork</span><br>          uvm_do_on(seq[<span class="hljs-number">2</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">2</span>]);<br>        <span class="hljs-keyword">join_none</span><br>        <span class="hljs-keyword">fork</span><br>          uvm_do_on(seq[<span class="hljs-number">3</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">3</span>]);<br>        <span class="hljs-keyword">join_none</span><br>	<span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<p>当着四个进行都调用了，body任务就执行完了，sequence就执行完了，系统会杀死这个sequence，清空之前占据的内存，也会杀死启动的进程，那么这几个进程还没执行完就被杀死，所以sequence根本没有执行。</p>
<p><strong>解决方法：</strong>wait fork</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-keyword">class</span> vseq <span class="hljs-keyword">extends</span> uvm_sequence;<br>	my_sequence seq[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>           <span class="hljs-keyword">fork</span><br>               <span class="hljs-keyword">automatic</span> <span class="hljs-keyword">int</span> j=i;<br>               `uvm_do_on(seq[j],p_sequencer<span class="hljs-variable">.p_sqr</span>[j]);<br>           <span class="hljs-keyword">join_none</span><br>        <span class="hljs-keyword">wait</span> <span class="hljs-keyword">fork</span>;   <span class="hljs-comment">//等待当前层次上的fork执行完。   </span><br>	<span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<p>相当于：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-keyword">class</span> vseq <span class="hljs-keyword">extends</span> uvm_sequence;<br>	my_sequence seq[<span class="hljs-number">4</span>];<br>     <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>        <span class="hljs-keyword">fork</span><br>          uvm_do_on(seq[<span class="hljs-number">0</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">0</span>]);<br>          uvm_do_on(seq[<span class="hljs-number">1</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">1</span>]);<br>          uvm_do_on(seq[<span class="hljs-number">2</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">2</span>]);<br>          uvm_do_on(seq[<span class="hljs-number">3</span>],p_sequencer<span class="hljs-variable">.p_sqr</span>[<span class="hljs-number">3</span>]);<br>        <span class="hljs-keyword">join</span> <span class="hljs-comment">//执行完 fork join才会往下执行</span><br>	<span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>



<h3 id="7-在sequence中使用config-db"><a href="#7-在sequence中使用config-db" class="headerlink" title="7. 在sequence中使用config_db"></a>7. 在sequence中使用config_db</h3><h4 id="7-1-在sequence中获得参数"><a href="#7-1-在sequence中获得参数" class="headerlink" title="7.1 在sequence中获得参数"></a>7.1 在sequence中获得参数</h4><p><strong>UVM中使用get_full_name()可以获得对象的层次路径。</strong>比如在一个sequence中调用这个函数，返回：</p>
<p><strong>uvm_test_top.env.i_agt.sqr.seq0</strong></p>
<p><strong>启动这个sequence的sequencer路径和这个sequence实例化时的名字</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-comment">// case中设置sequence中的参数</span><br><span class="hljs-keyword">function</span> <span class="hljs-keyword">void</span> my_case0::build_phase(uvm_phase phase);<br>   <span class="hljs-keyword">super</span><span class="hljs-variable">.build_phase</span>(phase);<br>	<span class="hljs-comment">// 设置sequence中的参数，用通配符</span><br>   uvm_config_db<span class="hljs-variable">#(int)::set(this, &quot;env.i_agt.sqr.*&quot;, &quot;count&quot;, 9)</span>;<br><br>   uvm_config_db<span class="hljs-variable">#(uvm_object_wrapper)</span>::set(<span class="hljs-keyword">this</span>, <br>                                           <span class="hljs-string">&quot;env.i_agt.sqr.main_phase&quot;</span>, <br>                                           <span class="hljs-string">&quot;default_sequence&quot;</span>, <br>                                           case0_sequence::type_id::get());<br><span class="hljs-keyword">endfunction</span><br></code></pre></td></tr></table></figure>

<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-comment">// 在sequence的pre_body中取得参数</span><br><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> case0_sequence::pre_body();<br>      <span class="hljs-keyword">if</span>(uvm_config_db<span class="hljs-variable">#(int)::get(null, get_full_name(), &quot;count&quot;, count))</span><br>         `uvm_info(<span class="hljs-string">&quot;seq0&quot;</span>, <span class="hljs-built_in">$sformatf</span>(<span class="hljs-string">&quot;get count value %0d via config_db&quot;</span>, count), UVM_MEDIUM)<br>      <span class="hljs-keyword">else</span><br>         `uvm_error(<span class="hljs-string">&quot;seq0&quot;</span>, <span class="hljs-string">&quot;can&#x27;t get count value!&quot;</span>) <br>   <span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>



<h4 id="7-2-在sequence中设置参数"><a href="#7-2-在sequence中设置参数" class="headerlink" title="7.2 在sequence中设置参数"></a>7.2 在sequence中设置参数</h4><p>在sequence可以向component设置参数；也可以向sequence中设置参数。</p>
<p>sequence是动态运行的，它什么时候要设置参数不固定，component需要知道什么时候sequence设置了参数，这通过<strong>wait_modified</strong>任务实现。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">//设置参数</span><br><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> case0_vseq::body();<br>      my_transaction tr;<br>      drv0_seq seq0;<br>      drv1_seq seq1;<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>      <span class="hljs-keyword">fork</span><br>         `uvm_do_on(seq0, p_sequencer<span class="hljs-variable">.p_sqr0</span>);<br>         `uvm_do_on(seq1, p_sequencer<span class="hljs-variable">.p_sqr1</span>);<br>         <span class="hljs-keyword">begin</span><br>            #<span class="hljs-number">10000</span>;<br>             uvm_config_db<span class="hljs-variable">#(bit)::set(uvm_root::get(), &quot;uvm_test_top.env0.scb&quot;, &quot;cmp_en&quot;, 0)</span>;<span class="hljs-comment">//向scb中设置参数</span><br>            #<span class="hljs-number">10000</span>;<br>            uvm_config_db<span class="hljs-variable">#(bit)::set(uvm_root::get(), &quot;uvm_test_top.env0.scb&quot;, &quot;cmp_en&quot;, 1)</span>;<br>         <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">join</span> <br>      #<span class="hljs-number">100</span>;<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br>   <span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-comment">// scb中取得参数</span><br><span class="hljs-keyword">task</span> my_scoreboard::main_phase(uvm_phase phase);<br>   my_transaction  get_expect,  get_actual, tmp_tran;<br>   <span class="hljs-keyword">bit</span> result;<br>   <span class="hljs-keyword">bit</span> cmp_en = <span class="hljs-number">1&#x27;b1</span>;<br> <br>   <span class="hljs-keyword">super</span><span class="hljs-variable">.main_phase</span>(phase);<br>   <span class="hljs-keyword">fork</span><br>      <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">begin</span><br>          <span class="hljs-comment">// 等待cmp_en改变，否则阻塞</span><br>         uvm_config_db<span class="hljs-variable">#(bit)::wait_modified(this, &quot;&quot;, &quot;cmp_en&quot;)</span>;<br>         <span class="hljs-keyword">void</span>&#x27;(uvm_config_db<span class="hljs-variable">#(bit)::get(this, &quot;&quot;, &quot;cmp_en&quot;, cmp_en))</span>; <br>         `uvm_info(<span class="hljs-string">&quot;my_scoreboard&quot;</span>, <span class="hljs-built_in">$sformatf</span>(<span class="hljs-string">&quot;cmp_en value modified, the new value is %0d&quot;</span>, cmp_en), UVM_LOW)<br>      <span class="hljs-keyword">end</span><br>     ...<br>   <span class="hljs-keyword">join</span><br><span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<p>sequence宏的wait_modified类似：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs verilog"> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> drv0_seq::body();<br>      <span class="hljs-keyword">bit</span> send_en = <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">fork</span><br>         <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">begin</span><br>            uvm_config_db<span class="hljs-variable">#(bit)::wait_modified(null, get_full_name(), &quot;send_en&quot;)</span>;<br>            <span class="hljs-keyword">void</span>&#x27;(uvm_config_db<span class="hljs-variable">#(bit)::get(null, get_full_name, &quot;send_en&quot;, send_en))</span>; <br>            `uvm_info(<span class="hljs-string">&quot;drv0_seq&quot;</span>, <span class="hljs-built_in">$sformatf</span>(<span class="hljs-string">&quot;send_en value modified, the new value is %0d&quot;</span>, send_en), UVM_LOW)<br>         <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">join_none</span><br>      <span class="hljs-keyword">repeat</span> (<span class="hljs-number">10</span>) <span class="hljs-keyword">begin</span><br>         `uvm_do(m_trans)<br>      <span class="hljs-keyword">end</span><br>   <span class="hljs-keyword">endtask</span><br><span class="hljs-comment">//在virtual sequence中启动这个sequence</span><br></code></pre></td></tr></table></figure>



<h3 id="8-sequence的响应"><a href="#8-sequence的响应" class="headerlink" title="8. sequence的响应"></a>8. sequence的响应</h3><p>UVM中的sequence机制提供了sequence-&gt;sequencer-&gt;driver的数据传输机制，有时sequence也需要知道driver的响应，进而sequence调整产生的transaction。</p>
<h4 id="8-1-put-response和get-response"><a href="#8-1-put-response和get-response" class="headerlink" title="8.1 put_response和get_response"></a>8.1 put_response和get_response</h4><p><strong>rsp是UVM中定义的变量。</strong></p>
<p><strong>在sequence中get  response：</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">// 在sequence获得response</span><br><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>      <span class="hljs-keyword">repeat</span> (<span class="hljs-number">10</span>) <span class="hljs-keyword">begin</span><br>          `uvm_do(m_trans)<span class="hljs-comment">//发送transaction</span><br>          get_response(rsp);<span class="hljs-comment">//发送完tr后获得响应</span><br>         `uvm_info(<span class="hljs-string">&quot;seq&quot;</span>, <span class="hljs-string">&quot;get one response&quot;</span>, UVM_MEDIUM)<br>         rsp<span class="hljs-variable">.print</span>();<span class="hljs-comment">//对相应进行处理</span><br>      <span class="hljs-keyword">end</span><br>      #<span class="hljs-number">100</span>;<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br>   <span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<p><strong>在driver中put response：</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Verilog"><span class="hljs-comment">// 在driver中返回响应</span><br><span class="hljs-keyword">task</span> my_driver::main_phase(uvm_phase phase);<br>   vif<span class="hljs-variable">.data</span> &lt;= <span class="hljs-number">8&#x27;b0</span>;<br>   vif<span class="hljs-variable">.valid</span> &lt;= <span class="hljs-number">1&#x27;b0</span>;<br>   <span class="hljs-keyword">while</span>(!vif<span class="hljs-variable">.rst_n</span>)<br>      @(<span class="hljs-keyword">posedge</span> vif<span class="hljs-variable">.clk</span>);<br>   <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">begin</span><br>      seq_item_port<span class="hljs-variable">.get_next_item</span>(req);<br>      drive_one_pkt(req);<br>       rsp = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;rsp&quot;</span>);<span class="hljs-comment">//驱动完tr后，put response</span><br>       rsp<span class="hljs-variable">.set_id_info</span>(req);<span class="hljs-comment">//设置id，将req与rsp对应</span><br>       seq_item_port<span class="hljs-variable">.put_response</span>(rsp);<span class="hljs-comment">//返回response</span><br>       seq_item_port<span class="hljs-variable">.item_done</span>();<span class="hljs-comment">//最后调用item_done告诉sqr我发送完一个tr了，你可以发送下一个tr给我了</span><br>   <span class="hljs-keyword">end</span><br><span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<p><strong>设置了id才知道哪个响应传给哪个sequence。</strong></p>
<p><strong>还可以直接在item_done中返回响应：</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-comment">// 在driver中返回响应</span><br><span class="hljs-keyword">task</span> my_driver::main_phase(uvm_phase phase);<br>   vif<span class="hljs-variable">.data</span> &lt;= <span class="hljs-number">8&#x27;b0</span>;<br>   vif<span class="hljs-variable">.valid</span> &lt;= <span class="hljs-number">1&#x27;b0</span>;<br>   <span class="hljs-keyword">while</span>(!vif<span class="hljs-variable">.rst_n</span>)<br>      @(<span class="hljs-keyword">posedge</span> vif<span class="hljs-variable">.clk</span>);<br>   <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">begin</span><br>      seq_item_port<span class="hljs-variable">.get_next_item</span>(req);<br>      drive_one_pkt(req);<br>      rsp = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;rsp&quot;</span>);<br>       rsp<span class="hljs-variable">.set_id_info</span>(req);<span class="hljs-comment">//设置id，将req与rsp对应</span><br>       seq_item_port<span class="hljs-variable">.item_done</span>(rsp);<br>   <span class="hljs-keyword">end</span><br><span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<p><strong>调用get_response(rsp)的时候，如果response_queue中没有响应，会阻塞在哪里，不能继续发送transaction。</strong></p>
<h4 id="8-2-response-handler和另类response"><a href="#8-2-response-handler和另类response" class="headerlink" title="8.2 response handler和另类response"></a>8.2 response handler和另类response</h4><p>上面提到的get_response阻塞问题，主要是因为发送transaction和get_response在同一个进程中，</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG">`uvm_do(m_trans)<span class="hljs-comment">//发送transaction</span><br> get_response(rsp);<span class="hljs-comment">//获得响应</span><br></code></pre></td></tr></table></figure>

<p>如果分开就可以解决阻塞问题，需要使用response_handler：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs VERILOG"><span class="hljs-keyword">class</span> case0_sequence <span class="hljs-keyword">extends</span> uvm_sequence <span class="hljs-variable">#(my_transaction)</span>;<br>   my_transaction m_trans;<br>...<br>   <br>   <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> pre_body();<br>       use_response_handler(<span class="hljs-number">1</span>);<span class="hljs-comment">//打开response_handler</span><br>   <span class="hljs-keyword">endtask</span><br>  <span class="hljs-comment">//重载response_handler函数</span><br>    <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">function</span> <span class="hljs-keyword">void</span> response_handler(uvm_sequence_item response);<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">$cast</span>(rsp, response))<span class="hljs-comment">//类型转换成my_transaction类型</span><br>         `uvm_error(<span class="hljs-string">&quot;seq&quot;</span>, <span class="hljs-string">&quot;can&#x27;t cast&quot;</span>)<br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">begin</span><br>         `uvm_info(<span class="hljs-string">&quot;seq&quot;</span>, <span class="hljs-string">&quot;get one response&quot;</span>, UVM_MEDIUM)<br>          rsp<span class="hljs-variable">.print</span>(); <span class="hljs-comment">//对响应进行处理</span><br>      <span class="hljs-keyword">end</span><br>   <span class="hljs-keyword">endfunction</span><br><br>   <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> body();<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>      <span class="hljs-keyword">repeat</span> (<span class="hljs-number">10</span>) <span class="hljs-keyword">begin</span><br>          `uvm_do(m_trans)<span class="hljs-comment">//body中只发送transaction</span><br>      <span class="hljs-keyword">end</span><br>      #<span class="hljs-number">100</span>;<br>      <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>         starting_phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br>   <span class="hljs-keyword">endtask</span><br><br>   `uvm_object_utils(case0_sequence)<br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<h4 id="8-3-另类的响应"><a href="#8-3-另类的响应" class="headerlink" title="8.3 另类的响应"></a>8.3 另类的响应</h4><p><strong>uvm_do执行完后，它的第一个参数不是空指针，而是指向刚刚发送到driver的transaction；可以在driver将需要返回的信息传给这个transaction中，在sequence中调用完&#96;uvm_do之后获取transaction中的信息。</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">//driver中返回信息到transaction</span><br><span class="hljs-keyword">task</span> my_driver::main_phase(uvm_phase phase);<br>   vif<span class="hljs-variable">.data</span> &lt;= <span class="hljs-number">8&#x27;b0</span>;<br>   vif<span class="hljs-variable">.valid</span> &lt;= <span class="hljs-number">1&#x27;b0</span>;<br>   <span class="hljs-keyword">while</span>(!vif<span class="hljs-variable">.rst_n</span>)<br>      @(<span class="hljs-keyword">posedge</span> vif<span class="hljs-variable">.clk</span>);<br>   <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">begin</span><br>      seq_item_port<span class="hljs-variable">.get_next_item</span>(req);<br>      drive_one_pkt(req);<br>      req<span class="hljs-variable">.frm_drv</span> = <span class="hljs-string">&quot;this is information from driver&quot;</span>;<span class="hljs-comment">//将信息存到穿过来的transaction中。</span><br>      seq_item_port<span class="hljs-variable">.item_done</span>();<br>   <span class="hljs-keyword">end</span><br><span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-comment">//在sequence获得driver返回的信息。</span><br><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">task</span> case0_sequence::body();<br>     <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>        starting_phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>     <span class="hljs-keyword">repeat</span> (<span class="hljs-number">10</span>) <span class="hljs-keyword">begin</span><br>        `uvm_do(m_trans)<br>        `uvm_info(<span class="hljs-string">&quot;seq&quot;</span>, <span class="hljs-built_in">$sformatf</span>(<span class="hljs-string">&quot;get information from driver: %0s&quot;</span>, m_trans<span class="hljs-variable">.frm_drv</span>), UVM_MEDIUM)<span class="hljs-comment">//获得driver返回的信息</span><br>     <span class="hljs-keyword">end</span><br>     #<span class="hljs-number">100</span>;<br>     <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>) <br>        starting_phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br>  <span class="hljs-keyword">endtask</span><br></code></pre></td></tr></table></figure>

<h3 id="9-sequence-library"><a href="#9-sequence-library" class="headerlink" title="9. sequence library"></a>9. sequence library</h3><p>根据特定算法随机选择注册在其中的sequence，并在body中执行这些sequence。</p>
<h3 id="10-补充一种启动sequence的方法"><a href="#10-补充一种启动sequence的方法" class="headerlink" title="10. 补充一种启动sequence的方法"></a>10. 补充一种启动sequence的方法</h3><p><strong>在sequence外，通过sequence句柄调用sequence中发送transaction的任务。</strong></p>
<p><strong>原理是：之前把发送transaction的语句写在了body中，sequence启动后，自动调用body，所以我们也可以把发送transaction语句写在其他任务中，让body为空。我们在sequence启动后，手动调用这些任务发送transaction。</strong></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-keyword">class</span> sequence1 <span class="hljs-keyword">extends</span> uvm_sequence<span class="hljs-variable">#(transaction)</span>;<br><br>`uvm_object_utils(sequence1);<br><span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span>(<span class="hljs-keyword">string</span> name=<span class="hljs-string">&quot;sequence1&quot;</span>);<br>  <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name);<br><span class="hljs-keyword">endfunction</span><br><span class="hljs-keyword">task</span> write();<br>  transaction tr;<br>  `uvm_info(get_type_name(),<span class="hljs-string">&quot;write&quot;</span>,UVM_LOW)<br>  `uvm_do(tr);<br><span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">task</span> read();<br>  transaction tr;<br>  `uvm_info(get_type_name(),<span class="hljs-string">&quot;read&quot;</span>,UVM_LOW)<br>  `uvm_do(tr);<br><span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">task</span> pre_body();<br>  <span class="hljs-keyword">if</span>(starting_phase != <span class="hljs-literal">null</span>)<br>    starting_phase<span class="hljs-variable">.raise_objection</span>(<span class="hljs-keyword">this</span>);<br>  `uvm_info(get_type_name(),<span class="hljs-string">&quot;pre_body&quot;</span>,UVM_LOW)<br><span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">task</span> body();<br>  `uvm_info(get_type_name(),<span class="hljs-string">&quot;body&quot;</span>,UVM_LOW)<br>  <span class="hljs-keyword">wait</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">task</span> post_body();<br>  `uvm_info(get_type_name(),<span class="hljs-string">&quot;post_body&quot;</span>,UVM_LOW)<br> <span class="hljs-keyword">if</span>(starting_phase!=<span class="hljs-literal">null</span>)<br>    starting_phase<span class="hljs-variable">.drop_objection</span>(<span class="hljs-keyword">this</span>);<br><span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br><span class="hljs-comment">//在case中启动启动</span><br><span class="hljs-keyword">class</span> case0 <span class="hljs-keyword">extends</span> base_test;<br>  `uvm_component_utils(case0);<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-keyword">new</span>(<span class="hljs-keyword">string</span> name=<span class="hljs-string">&quot;case0&quot;</span>,uvm_component parent=<span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">super</span><span class="hljs-variable">.new</span>(name,parent);<br>  <span class="hljs-keyword">endfunction</span><br><br>  <span class="hljs-keyword">task</span> run_phase(uvm_phase phase);<br>  sequence1 seq1;<br>    seq1=<span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;seq1&quot;</span>);<br>  <span class="hljs-keyword">fork</span><br>      <span class="hljs-keyword">begin</span><br>    seq1<span class="hljs-variable">.starting_phase</span> = phase;<br>    seq1<span class="hljs-variable">.start</span>(env0<span class="hljs-variable">.sqr</span>);<br>      <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">begin</span><br>          <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++) <span class="hljs-keyword">begin</span><br>            seq1<span class="hljs-variable">.write</span>();<br>            seq1<span class="hljs-variable">.read</span>();<br>          <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">join_none</span><br>  <span class="hljs-keyword">endtask</span><br><span class="hljs-keyword">endclass</span><br></code></pre></td></tr></table></figure>

<p>结果如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">27</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">13</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> write<br><span class="hljs-number">28</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">25</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> pre_body<br><span class="hljs-number">29</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">28</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> <span class="hljs-selector-tag">body</span><br><span class="hljs-number">54</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">19</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> read<br><span class="hljs-number">79</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">13</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> write<br>....<br><span class="hljs-number">454</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">19</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> read<br><span class="hljs-number">479</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">13</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> write<br><span class="hljs-number">504</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">19</span>) @ <span class="hljs-number">0</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> read<br><span class="hljs-number">529</span>:UVM_INFO seq/sequence1<span class="hljs-selector-class">.sv</span>(<span class="hljs-number">33</span>) @ <span class="hljs-number">1000000</span>: uvm_test_top<span class="hljs-selector-class">.env0</span>.sqr@@seq1 <span class="hljs-selector-attr">[sequence1]</span> post_body<br><span class="hljs-number">543</span>:<span class="hljs-selector-attr">[sequence1]</span>    <span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Verification/">Verification</a>
                    
                      <a class="hover-with-bg" href="/categories/Verification/UVM/">UVM</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/IC/">IC</a>
                    
                      <a class="hover-with-bg" href="/tags/SV/">SV</a>
                    
                      <a class="hover-with-bg" href="/tags/Verification/">Verification</a>
                    
                      <a class="hover-with-bg" href="/tags/UVM/">UVM</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/08/08/Verification/UVM/UVM%E2%80%94%E2%80%94sequence%EF%BC%88%E4%B8%80%EF%BC%89/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">UVM——sequence（一）</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/08/07/Verilog/Verilog%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/">
                        <span class="hidden-mobile">Verilog——文件读写</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
